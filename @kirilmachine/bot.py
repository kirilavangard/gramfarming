import asyncio
from telethon import TelegramClient
from telethon.tl.functions.messages import SendMessageRequest
from telethon.tl.functions.account import UpdateProfileRequest
from telethon.errors import FloodWaitError

# --- —Ç–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ --- –∏–¥,—Ö–µ—à, –Ω–æ–º–µ—Ä #–ö–¢–û –¢–ê–ö–û–ô –ó–ê–•–ê–† –ê–í–ê–ù–ì–ê–†–î –ø–æ –≤–æ–ø—Ä–æ—Å–∞–º —Å–∫—Ä–∏–ø—Ç–∞ –∏–ª–∏ –µ–ª–∏ –∑–∞—Ö–æ—Ç–∏—Ç–µ —á—Ç–æ–±—ã —è —É–¥–∞–ª–∏–ª —Å–∫—Ä–∏–ø—Ç –∏–ª–∏ –ø–æ–º–æ–≥ —É—Å—Ç—Ä–∞–Ω–∏—Ç—å –¥—ã—Ä—ã –∏–ª–∏ —Å–¥–µ–ª–∞—Ç—å –Ω–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç  @kirilmachine
accounts = [
    {
        "api_id": ,  # –∑–∞–º–µ–Ω–∏ –Ω–∞ —Å–≤–æ–π api_id
        "api_hash": '',  # –∑–∞–º–µ–Ω–∏ –Ω–∞ —Å–≤–æ–π api_hash
        "phone": '+',  # –∑–∞–º–µ–Ω–∏ –Ω–∞ —Å–≤–æ–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ c +
        "session_name": 'my_telegram_session'  # –∏–º—è —Ñ–∞–π–ª–∞ —Å–µ—Å—Å–∏–∏
    },
    # –î–æ–±–∞–≤—å—Ç–µ –±–æ–ª—å—à–µ –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –≤ —ç—Ç–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
]

# –°–ø–∏—Å–æ–∫ –±–æ—Ç–æ–≤, —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –∑–∞–¥–µ—Ä–∂–µ–∫ –±–æ—Ç–æ–≤ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –¥—é–æ–µ –∫–æ–ª–∏—á–µ—Ç–≤–æ –∫–∞–∫ –∏ –∞–∫–∫–æ–≤
bots_and_messages = [
    {
        "username": "valyutaTG_bot",  # –∏–º—è –ø–µ—Ä–≤–æ–≥–æ –±–æ—Ç–∞ –±–µ–∑ @
        "message": "üéÅ–ë–æ–Ω—É—Å –æ—Ç –ø–µ—Ä–≤–æ–≥–æ –±–æ—Ç–∞",
        "delay":  86400  # –∑–∞–¥–µ—Ä–∂–∫–∞ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö 1 –¥–µ–Ω—å
    },
    {
        "username": "secondBot",  # –∏–º—è –≤—Ç–æ—Ä–æ–≥–æ –±–æ—Ç–∞ –±–µ–∑ @
        "message": "üéâ–°–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –≤—Ç–æ—Ä–æ–≥–æ –±–æ—Ç–∞",
        "delay":  86400 # –∑–∞–¥–µ—Ä–∂–∫–∞ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö 1 –¥–µ–Ω—å
    },
    {
        "username": "thirdBot",  # –∏–º—è —Ç—Ä–µ—Ç—å–µ–≥–æ –±–æ—Ç–∞ –±–µ–∑ @
        "message": "üíå–°–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è —Ç—Ä–µ—Ç—å–µ–≥–æ –±–æ—Ç–∞",
        "delay":  14400  # –∑–∞–¥–µ—Ä–∂–∫–∞ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö 4 —á–∞—Å–∞ 
    }
]

async def main():
    for account in accounts:
        client = TelegramClient(account["session_name"], account["api_id"], account["api_hash"])
        await client.start(phone=account["phone"])
        print(f"–ö–ª–∏–µ–Ω—Ç –∑–∞–ø—É—â–µ–Ω –¥–ª—è: {account['phone']}")

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∞–∫–∫–∞—É–Ω—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç
        me = await client.get_me()
        print(f"–ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω –∫–∞–∫: {me.first_name}")

        # –ò–∑–º–µ–Ω—è–µ–º –∏–º—è –∏ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è,—Ç–∞–º –≥–¥–µ –Ω–∞—Å –Ω–µ—Ç –≤—Å–µ–≥–¥–∞ –ª—É—á—à–∏–π –º–∏–Ω–µ—Ç
        new_name = "–ó–∞—Ö–∞—Ä –ê–≤–∞–Ω–≥–∞—Ä–¥"  # –ó–∞–¥–∞–π—Ç–µ –Ω–æ–≤–æ–µ –∏–º—è
        new_about = "@IrisAdvanceChat - –ø–µ—Ä–≤—ã–π –∏–≥—Ä–æ–≤–æ–π –±–æ—Ç, –≤ –∫–æ—Ç–æ—Ä–æ–º –∏–≥—Ä–∞–µ—à—å –∏—Ä–∏—Å–∫–∞–º–∏ üç¨"  # –ó–∞–¥–∞–π—Ç–µ –Ω–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
        await client(UpdateProfileRequest(first_name=new_name, about=new_about))
        print(f"–ò–º—è –∏ –æ–ø–∏—Å–∞–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã –¥–ª—è: {me.first_name}")

        while True:
            for bot in bots_and_messages:
                try:
                    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç—É
                    await client.send_message(bot["username"], bot["message"])
                    print(f"–°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –±–æ—Ç—É: {bot['message']}")

                    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—Ç–≤–µ—Ç –æ—Ç –±–æ—Ç–∞,–∫–∏–¥–∞–π—Ç–µ –±–æ—Ç–æ–≤ ,–±—É–¥—É —Ä–∞–¥–æ–≤–∞—Ç—å –≤–∞—Å —Å–∫—Ä–∏–ø—Ç–∞–º–∏
                    await asyncio.sleep(5)  # –ñ–¥–µ–º –Ω–µ–º–Ω–æ–≥–æ, —á—Ç–æ–±—ã –±–æ—Ç –º–æ–≥ –æ—Ç–≤–µ—Ç–∏—Ç—å
                    messages = await client.get_messages(bot["username"], limit=1)
                    
                    if messages and messages[0].from_id == me.id:
                        print("–û—Ç–≤–µ—Ç –æ—Ç –±–æ—Ç–∞ –Ω–µ –ø–æ–ª—É—á–µ–Ω.")
                    else:
                        print("–ü–æ–ª—É—á–µ–Ω –æ—Ç–≤–µ—Ç –æ—Ç –±–æ—Ç–∞.")

                except FloodWaitError as e:
                    print(f"–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤. –û–∂–∏–¥–∞–Ω–∏–µ: {e.seconds} —Å–µ–∫—É–Ω–¥.")
                    await asyncio.sleep(e.seconds)

                except Exception as e:
                    print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è: {e}")

                # –ñ–¥–µ–º –∑–∞–¥–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è –ø–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–∏–º –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –µ—Å–ª–∏ –±—É–¥–µ—Ç–µ —Å—Ç–∞–≤–∏—Ç—å –Ω–∞ –±–µ–∑ —Ö–æ—Å—Ç–∏–Ω–≥–∞ —Ç–æ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –≤—Ä–µ–º—è —Å–±—Ä–æ—Å–∏—Ç—Å—è
                await asyncio.sleep(bot["delay"])  # –ó–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –±–æ—Ç–∞

if __name__ == '__main__':
    asyncio.run(main())
